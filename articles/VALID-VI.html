<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the **R Markdown Document Validation** Workflow (**VALID-VI**) • pointblank</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the **R Markdown Document Validation** Workflow (**VALID-VI**)">
<meta property="og:description" content="pointblank">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pointblank</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Development version">0.7.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Validation Workflows</li>
    <li>
      <a href="../articles/validation_workflows.html">Overview</a>
    </li>
    <li>
      <a href="../articles/VALID-I.html">VALID-I: Data Quality Reporting</a>
    </li>
    <li>
      <a href="../articles/VALID-II.html">VALID-II: Pipeline Data Validation</a>
    </li>
    <li>
      <a href="../articles/VALID-III.html">VALID-III: Expectations in Unit Tests</a>
    </li>
    <li>
      <a href="../articles/VALID-IV.html">VALID-IV: Data Tests for Conditionals</a>
    </li>
    <li>
      <a href="../articles/VALID-V.html">VALID-V: Table Scan</a>
    </li>
    <li>
      <a href="../articles/VALID-VI.html">VALID-VI: R Markdown Document Validation</a>
    </li>
    <li class="dropdown-header">Information Management</li>
    <li>
      <a href="../articles/INFO-1.html">Intro to Information Management</a>
    </li>
    <li>
      <a href="../articles/INFO-2.html">Advanced Information Management</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rich-iannone/pointblank/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="VALID-VI_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the <strong>R Markdown Document Validation</strong> Workflow (<strong>VALID-VI</strong>)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rich-iannone/pointblank/blob/master/vignettes/VALID-VI.Rmd" class="external-link"><code>vignettes/VALID-VI.Rmd</code></a></small>
      <div class="hidden name"><code>VALID-VI.Rmd</code></div>

    </div>

    
    
<p><img src="images/VALID-VI.svg" width="100%"></p>
<p>The <em>R Markdown Document Validation</em> workflow involves interspersing bits of different workflows in the larger R Markdown workflow. It’s great to use when doing data analysis work in the familiar <em>R Markdown</em> environment, striking a balance between checking your work and getting a bit out of the way when the document is rendered to HTML.</p>
<div id="how-it-works" class="section level1">
<h1 class="hasAnchor">
<a href="#how-it-works" class="anchor" aria-hidden="true"></a>How It Works</h1>
<p>Using <strong>pointblank</strong> in the <strong>VALID-VI</strong> workflow is enabled by default once the <strong>pointblank</strong> library is loaded (best done in the <code>setup</code> chunk). The framework allows for validation testing within specialized validation code chunks where the <code>validate = TRUE</code> option is set. Using <strong>pointblank</strong> validation functions on data (the <a href="../articles/VALID-II.html"><strong>VALID-II</strong></a> workflow) in these marked code chunks will flag overall failure if the stop threshold is exceeded anywhere.</p>
<p>All errors are shown after rendering the document to HTML. Green status buttons indicate that all validations succeeded, red buttons indicate that one or more validation failures occurred. Clicking any such button reveals the otherwise hidden validation statements and associated messaging.</p>
<p>It’s much better to demonstrate how this workflow works in a series of examples, as the resulting output is interactive and varies quite a bit depending on the input. In all of the following examples, a code chunk will shown and the rendered result will be subsequently placed. The result will typically be a button that can be pressed to reveal the validation result and the code chunk itself is hidden upon rendering (so there’s no need to use <code>include = FALSE</code> as a chunk option).</p>
<p>To start things off, here’s an example that uses an expression that takes the <code>small_table</code> dataset and pipes it to two validation functions: <code><a href="../reference/col_is_date.html">col_is_date()</a></code> and <code><a href="../reference/col_vals_in_set.html">col_vals_in_set()</a></code>. The <code><a href="../reference/col_is_date.html">col_is_date()</a></code> validation passes whereas the <code><a href="../reference/col_vals_in_set.html">col_vals_in_set()</a></code> validation fails (because the set of values in column <code>f</code> also has the <code>"high"</code> value.</p>
<p><img src="images/code_block_1.png"></p>

<div class="pointblank-badge-container-inner" style="text-align: center; padding-bottom: 12px; font-size: 16px;">
  <span class="pointblank-badge label label-danger" data-toggle="collapse" data-target="#chunk-3608739" aria-expanded="false" aria-controls="chunk-3608739" style="cursor: pointer;">1 validation failed.</span>
</div>
<div id="chunk-3608739" class="pointblank-chunk panel panel-danger collapse">
  <div class="panel" style="margin-bottom: 0px;">
    <div class="panel-body" style="padding-left: 18px; padding-top: 18px; padding-right: 18px; padding-bottom: 0px; background: #FAFAFA;">
      <div class="panel panel-danger">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 3px; fill: red;"><path d="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 12.21875 10.78125 L 10.78125 12.21875 L 14.5625 16 L 10.78125 19.78125 L 12.21875 21.21875 L 16 17.4375 L 19.78125 21.21875 L 21.21875 19.78125 L 17.4375 16 L 21.21875 12.21875 L 19.78125 10.78125 L 16 14.5625 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">small_table %&gt;% 
  col_is_date("date") %&gt;% 
  col_vals_in_set(vars(f), set = c("low", "mid"))</code>
      </div>
    </div>
    <hr style="margin-top:10px;margin-bottom:0;border:1px solid #EBCCD1;">
<div class="panel-body" style="padding-left:15px;padding-top:15px;padding-right:15px;padding-bottom:15px;background:#FAFAFA;width:100%;overflow-x:scroll;">
      <code style="background-color:#FAFAFA;padding-left:0;overflow-x:scroll;">## Error: Exceedance of failed test units where values in `f` should have been in the set of `low`, `mid`.
## The `col_vals_in_set()` validation failed beyond the absolute threshold level (1).
## * failure level (6) &gt;= failure threshold (1)</code>
    </div>
    <hr style="margin-top:0;margin-bottom:0;border:1px solid #EBCCD1;">
</div>
</div>
    </div>
  </div>
</div>

<p>Clicking the above <code>1 validation failed.</code> button will reveal that the <em>expression</em> failed validation because of a validation function failing within it. If you break it down, really one validation step in the chain passed (the first one) and one failed (the second). If there were additional validation steps that would otherwise pass, we’d still get the same result and output because the failing step ends execution.</p>
<p>Because this workflow is meant to stop an expression from executing at the first validation function that fails, it’s advisable to break down these validations to single steps. That way, each expression is a single validation that either passes or fails and is reported accordingly. Let’s rewrite the above example as two expressions, one per validation.</p>
<p><img src="images/code_block_2.png"></p>

<div class="pointblank-badge-container-inner" style="text-align: center; padding-bottom: 12px; font-size: 16px;">
  <span class="pointblank-badge label label-danger" data-toggle="collapse" data-target="#chunk-4129148" aria-expanded="false" aria-controls="chunk-4129148" style="cursor: pointer;">1 validation failed.</span>
</div>
<div id="chunk-4129148" class="pointblank-chunk panel panel-danger collapse">
  <div class="panel" style="margin-bottom: 0px;">
    <div class="panel-body" style="padding-left: 18px; padding-top: 18px; padding-right: 18px; padding-bottom: 0px; background: #FAFAFA;">
      <div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_is_date(small_table, "date")</code>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-danger">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 3px; fill: red;"><path d="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 12.21875 10.78125 L 10.78125 12.21875 L 14.5625 16 L 10.78125 19.78125 L 12.21875 21.21875 L 16 17.4375 L 19.78125 21.21875 L 21.21875 19.78125 L 17.4375 16 L 21.21875 12.21875 L 19.78125 10.78125 L 16 14.5625 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_vals_in_set(small_table, vars(f), set = c("low", "mid"))</code>
      </div>
    </div>
    <hr style="margin-top:10px;margin-bottom:0;border:1px solid #EBCCD1;">
<div class="panel-body" style="padding-left:15px;padding-top:15px;padding-right:15px;padding-bottom:15px;background:#FAFAFA;width:100%;overflow-x:scroll;">
      <code style="background-color:#FAFAFA;padding-left:0;overflow-x:scroll;">## Error: Exceedance of failed test units where values in `f` should have been in the set of `low`, `mid`.
## The `col_vals_in_set()` validation failed beyond the absolute threshold level (1).
## * failure level (6) &gt;= failure threshold (1)</code>
    </div>
    <hr style="margin-top:0;margin-bottom:0;border:1px solid #EBCCD1;">
</div>
</div>
    </div>
  </div>
</div>

<p>It still says that <code>1 validation failed.</code> (this workflow focuses on the negatives) but pressing the button reveals that the first one passed and the second failed. This is much clearer and we don’t run the risk of not evaluating validations because a validation failed earlier in a pipeline.</p>
<p>Here’s an example where all validations in individual expressions pass, showing us a green status button.</p>
<p><img src="images/code_block_3.png"></p>

<div class="pointblank-badge-container-inner" style="text-align: center; padding-bottom: 12px; font-size: 16px;">
  <span class="pointblank-badge label label-success" data-toggle="collapse" data-target="#chunk-2457339" aria-expanded="false" aria-controls="chunk-2457339" style="cursor: pointer;">All validations passed.</span>
</div>
<div id="chunk-2457339" class="pointblank-chunk panel panel-success collapse">
  <div class="panel" style="margin-bottom: 0px;">
    <div class="panel-body" style="padding-left: 18px; padding-top: 18px; padding-right: 18px; padding-bottom: 0px; background: #FAFAFA;">
      <div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_is_date(small_table, "date")</code>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_is_posix(small_table, vars(date_time))</code>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_vals_in_set(small_table, vars(f), set = c("low", "mid", "high"))</code>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_vals_lt(small_table, vars(a), value = 10)</code>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_vals_regex(small_table, vars(b), regex = "^[0-9]-[a-z]{3}-[0-9]{3}$")</code>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">col_vals_between(small_table, vars(d), left = 0, right = 10000)</code>
      </div>
    </div>
  </div>
</div>
    </div>
  </div>
</div>

<p>It’s worth reminding at this point that failed validations do not stop execution of the R Markdown rendering. Otherwise you wouldn’t see a document with any failing validations, and, you wouldn’t know where those failed validations occurred. The expectation for this workflow is to add in the relevant validation expressions at key junctures and should any failures occur, one can fix the underlying issues until all (or enough) validations pass.</p>
</div>
<div id="the-pointblank-stop_if_not-function" class="section level1">
<h1 class="hasAnchor">
<a href="#the-pointblank-stop_if_not-function" class="anchor" aria-hidden="true"></a>The <strong>pointblank</strong> <code>stop_if_not()</code> Function</h1>
<p>You may not want to use the set of validation functions for everything. Perhaps using <code><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot()</a></code> is sufficient for some validations. In that case, consider using <strong>pointblank</strong> variation on that: <code><a href="../reference/stop_if_not.html">stop_if_not()</a></code>. It works well enough as a standalone, replacement for <code><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot()</a></code> but the advantage here is that <code><a href="../reference/stop_if_not.html">stop_if_not()</a></code> is customized for use in the <strong>VALID-VI</strong> workflow (or in any situation where you’re using R Markdown to render to HTML, and <strong>pointblank</strong> is loaded via <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code>). Ultimately, using <code><a href="../reference/stop_if_not.html">stop_if_not()</a></code> in a code chunk where the <code>validate = TRUE</code> option is set will yield the correct reporting of successes and failures whereas <code><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot()</a></code> does not.</p>
<p>Here’s a code chunk that uses <code><a href="../reference/stop_if_not.html">stop_if_not()</a></code> twice to check two different assertions on the <code>small_table</code> object. The first one passes whereas the second one fails.</p>
<p><img src="images/code_block_4.png"></p>

<div class="pointblank-badge-container-inner" style="text-align: center; padding-bottom: 12px; font-size: 16px;">
  <span class="pointblank-badge label label-danger" data-toggle="collapse" data-target="#chunk-1050682" aria-expanded="false" aria-controls="chunk-1050682" style="cursor: pointer;">1 validation failed.</span>
</div>
<div id="chunk-1050682" class="pointblank-chunk panel panel-danger collapse">
  <div class="panel" style="margin-bottom: 0px;">
    <div class="panel-body" style="padding-left: 18px; padding-top: 18px; padding-right: 18px; padding-bottom: 0px; background: #FAFAFA;">
      <div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">stop_if_not(nrow(small_table) &lt; 20)</code>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-danger">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 3px; fill: red;"><path d="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 12.21875 10.78125 L 10.78125 12.21875 L 14.5625 16 L 10.78125 19.78125 L 12.21875 21.21875 L 16 17.4375 L 19.78125 21.21875 L 21.21875 19.78125 L 17.4375 16 L 21.21875 12.21875 L 19.78125 10.78125 L 16 14.5625 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;">stop_if_not("time" %in% colnames(small_table))</code>
      </div>
    </div>
    <hr style="margin-top:10px;margin-bottom:0;border:1px solid #EBCCD1;">
<div class="panel-body" style="padding-left:15px;padding-top:15px;padding-right:15px;padding-bottom:15px;background:#FAFAFA;width:100%;overflow-x:scroll;">
      <code style="background-color:#FAFAFA;padding-left:0;overflow-x:scroll;">## Error: '"time" %in% colnames(small_table)' is not TRUE.</code>
    </div>
    <hr style="margin-top:0;margin-bottom:0;border:1px solid #EBCCD1;">
</div>
</div>
    </div>
  </div>
</div>

<p>Keep in mind that <code><a href="../reference/stop_if_not.html">stop_if_not()</a></code> (like <code><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot()</a></code>) can be used for any type of assertion. It’s not limited to checking tables like the functions in <strong>pointblank</strong> are focused on.</p>
<div id="including-data-quality-reporting-from-the-valid-i-workflow" class="section level4">
<h4 class="hasAnchor">
<a href="#including-data-quality-reporting-from-the-valid-i-workflow" class="anchor" aria-hidden="true"></a>Including Data Quality Reporting from the <strong>VALID-I</strong> Workflow</h4>
<p>Code chunks can include data quality reporting expressions (i.e., the <em>agent</em>-based <a href="../articles/VALID-I.html"><strong>VALID-I</strong></a> workflow) but it’s important to ensure two things. Here’s the interesting thing about that: we can opt to use <code>validate = TRUE</code> as a chunk option or omit that entirely, each choice has different effect. If you’d like to hide the validation output (the <em>Agent Report</em>) behind a button (in this case, a light blue one) then <code>validate = TRUE</code> should be used.</p>
<p>Here’s an example of a data quality validation workflow being executed in a single code chunk.</p>
<p><img src="images/code_block_5.png"></p>

<div class="pointblank-badge-container-inner" style="text-align: center; padding-bottom: 12px; font-size: 16px;">
  <span class="pointblank-badge label label-success" data-toggle="collapse" data-target="#chunk-9010601" aria-expanded="false" aria-controls="chunk-9010601" style="cursor: pointer;">All validations passed.</span>
</div>
<div id="chunk-9010601" class="pointblank-chunk panel panel-success collapse">
  <div class="panel" style="margin-bottom: 0px;">
    <div class="panel-body" style="padding-left: 18px; padding-top: 18px; padding-right: 18px; padding-bottom: 0px; background: #FAFAFA;">
      <div class="panel panel-success">
  <div class="panel-heading" style="color:#333;border-color:transparent;">
    <div style="display:inline-flex;width:100%;">
      <div style="margin-top:2px;padding-left:5px;background:#FAFAFA;"><svg height="1.5em" viewbox="0 0 32 32" style="margin-top: 1px; fill: green;"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"></path></svg></div>
      <div style="padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:4px;margin-top:2px;background:#FAFAFA;width:100%;overflow-x:scroll;">
        <code style="background-color:#FAFAFA;padding-left:0;"># Define an `action_levels` object
al &lt;- action_levels(warn_at = 0.1, stop_at = 0.2)

# Perform a validation with an `agent`
create_agent(
    tbl = small_table,
    tbl_name = "small_table",
    label = "VALID-I Example No. 2",
    actions = al
  ) %&gt;%
  col_is_posix(vars(date_time)) %&gt;%
  col_vals_in_set(vars(f), set = c("low", "mid")) %&gt;%
  col_vals_lt(vars(a), value = 7) %&gt;%
  col_vals_regex(vars(b), regex = "^[0-9]-[a-w]{3}-[2-9]{3}$") %&gt;%
  col_vals_between(vars(d), left = 0, right = 4000) %&gt;%
  interrogate()</code>
      </div>
    </div>
  </div>
</div>
    </div>
  </div>
</div>

<p>If this code chunk were to exclude the <code>validate = TRUE</code> option, then the output would appear as output normally does (where the input appears above output report table). Should you just want the output reporting table to shown without the input expressions, you could use the <code>include = FALSE</code> chunk option here.</p>
<p>As a final note for this, it’s important not to use any other expressions that result in output, just stick to the typical <code><a href="../reference/create_agent.html">create_agent()</a></code> → <code>&lt;validation functions&gt;</code> → <code><a href="../reference/interrogate.html">interrogate()</a></code> pattern. In other words, dedicate this code chunk just to the <em>agent</em> and put other validation expressions elsewhere in the document.</p>
</div>
</div>
<div id="setting-up-options-with-the-validate_rmd-function" class="section level1">
<h1 class="hasAnchor">
<a href="#setting-up-options-with-the-validate_rmd-function" class="anchor" aria-hidden="true"></a>Setting Up Options with the <code>validate_rmd()</code> Function</h1>
<p>We can modify the <strong>pointblank</strong> validation testing options within R Markdown documents with the <code><a href="../reference/validate_rmd.html">validate_rmd()</a></code> function. While the framework for such testing is set up by default, using <code><a href="../reference/validate_rmd.html">validate_rmd()</a></code> offers an opportunity to set up UI and logging options.</p>
<p>With the <code>summary</code> argument, if <code>TRUE</code> (the default), then there will be a leading summary of all validations in the rendered R Markdown document. With <code>FALSE</code>, this element is not shown. For this document, <code>validate_rmd(summary = FALSE)</code> was placed in the <code>setup</code> chunk (right after the <code><a href="https://rich-iannone.github.io/pointblank/" class="external-link">library(pointblank)</a></code> statement) and this resulted in suppressing the display of the overall summary of validation results.</p>
<p>With the <code>log_to_file</code> argument, there’s the option to log errors to a text file. By default, no logging is done but setting <code>log_to_file == TRUE</code> will write log entries to the <code>"validation_errors.log"</code> file in the working directory (will be generated if non-existent, appended to if available). To both enable logging and specify the name of the file, include a path to a log file (with the desired name) to <code>log_to_file</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Richard Iannone, Mauricio Vargas.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
