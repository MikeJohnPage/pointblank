<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the **Data Tests for Conditionals** Workflow (**VALID-IV**) • pointblank</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the **Data Tests for Conditionals** Workflow (**VALID-IV**)">
<meta property="og:description" content="pointblank">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pointblank</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Development version">0.8.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Validation Workflows</li>
    <li>
      <a href="../articles/validation_workflows.html">Overview</a>
    </li>
    <li>
      <a href="../articles/VALID-I.html">VALID-I: Data Quality Reporting</a>
    </li>
    <li>
      <a href="../articles/VALID-II.html">VALID-II: Pipeline Data Validation</a>
    </li>
    <li>
      <a href="../articles/VALID-III.html">VALID-III: Expectations in Unit Tests</a>
    </li>
    <li>
      <a href="../articles/VALID-IV.html">VALID-IV: Data Tests for Conditionals</a>
    </li>
    <li>
      <a href="../articles/VALID-V.html">VALID-V: Table Scan</a>
    </li>
    <li>
      <a href="../articles/VALID-VI.html">VALID-VI: R Markdown Document Validation</a>
    </li>
    <li class="dropdown-header">Information Management</li>
    <li>
      <a href="../articles/INFO-1.html">Intro to Information Management</a>
    </li>
    <li>
      <a href="../articles/INFO-2.html">Advanced Information Management</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rich-iannone/pointblank/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="VALID-IV_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the <strong>Data Tests for Conditionals</strong> Workflow (<strong>VALID-IV</strong>)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rich-iannone/pointblank/blob/master/vignettes/VALID-IV.Rmd" class="external-link"><code>vignettes/VALID-IV.Rmd</code></a></small>
      <div class="hidden name"><code>VALID-IV.Rmd</code></div>

    </div>

    
    
<p><img src="images/VALID-IV.svg" width="100%"></p>
<p>The <em>VALID-IV: Data Tests for Conditionals</em> workflow is probably not much of a workflow really. But maybe you consider programming and control flow a sort of workflow. If that’s the case and you are programming with data, the functions of this workflow might be useful for that. A set of <code>test_*()</code> functions, with the same arguments as the corresponding <code>expect_*()</code> functions of the <a href="../articles/VALID-III.html"><strong>VALID-III</strong></a> workflow, are used with data tables and the result of each call returns a single logical value (<code>TRUE</code> or <code>FALSE</code>). Here’s the complete list of functions with a phrase for what each function tests:</p>
<ul>
<li>
<code><a href="../reference/col_vals_lt.html">test_col_vals_lt()</a></code>: Test whether column data are less than a specified value.</li>
<li>
<code><a href="../reference/col_vals_lte.html">test_col_vals_lte()</a></code>: Test whether column data are less than or equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_equal.html">test_col_vals_equal()</a></code>: Test whether column data are equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_not_equal.html">test_col_vals_not_equal()</a></code>: Test whether column data are not equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_gte.html">test_col_vals_gte()</a></code>: Test whether column data are greater than or equal to a specified value.</li>
<li>
<code><a href="../reference/col_vals_gt.html">test_col_vals_gt()</a></code>: Test whether column data are greater than a specified value.</li>
<li>
<code><a href="../reference/col_vals_between.html">test_col_vals_between()</a></code>: Test whether column data are between two specified values.</li>
<li>
<code><a href="../reference/col_vals_not_between.html">test_col_vals_not_between()</a></code>: Test whether column data are not between two specified values.</li>
<li>
<code><a href="../reference/col_vals_in_set.html">test_col_vals_in_set()</a></code>: Test whether column data are part of a specified set of values.</li>
<li>
<code><a href="../reference/col_vals_not_in_set.html">test_col_vals_not_in_set()</a></code>: Test whether column data are not part of a specified set of values.</li>
<li>
<code><a href="../reference/col_vals_null.html">test_col_vals_null()</a></code>: Test whether column data are <code>NULL</code>/<code>NA</code>.</li>
<li>
<code><a href="../reference/col_vals_not_null.html">test_col_vals_not_null()</a></code>: Test whether column data are not <code>NULL</code>/<code>NA</code>.</li>
<li>
<code><a href="../reference/col_vals_regex.html">test_col_vals_regex()</a></code>: Test whether strings in column data match a regex pattern.</li>
<li>
<code><a href="../reference/col_vals_expr.html">test_col_vals_expr()</a></code>: Test whether column data agree with a predicate expression.</li>
<li>
<code><a href="../reference/conjointly.html">test_conjointly()</a></code>: Test whether multiple rowwise validations result in joint validity.</li>
<li>
<code><a href="../reference/rows_distinct.html">test_rows_distinct()</a></code>: Test whether row data are distinct.</li>
<li>
<code><a href="../reference/col_is_character.html">test_col_is_character()</a></code>: Test whether the columns contain character/string data.</li>
<li>
<code><a href="../reference/col_is_numeric.html">test_col_is_numeric()</a></code>: Test whether the columns contain numeric values.</li>
<li>
<code><a href="../reference/col_is_integer.html">test_col_is_integer()</a></code>: Test whether the columns contain integer values.</li>
<li>
<code><a href="../reference/col_is_logical.html">test_col_is_logical()</a></code>: Test whether the columns contain logical values.</li>
<li>
<code><a href="../reference/col_is_date.html">test_col_is_date()</a></code>: Test whether the columns contain R <code>Date</code> objects.</li>
<li>
<code><a href="../reference/col_is_posix.html">test_col_is_posix()</a></code>: Test whether the columns contain <code>POSIXct</code> dates.</li>
<li>
<code><a href="../reference/col_is_factor.html">test_col_is_factor()</a></code>: Test whether the columns contain R <code>factor</code> objects.</li>
<li>
<code><a href="../reference/col_exists.html">test_col_exists()</a></code>: Test whether one or more columns actually exist.</li>
<li>
<code><a href="../reference/col_schema_match.html">test_col_schema_match()</a></code>: Test whether columns in the table (and their types) match a predefined schema.</li>
</ul>
<div id="exactly-like-the-expect_-functions-except-you-get-a-true-or-false" class="section level1">
<h1 class="hasAnchor">
<a href="#exactly-like-the-expect_-functions-except-you-get-a-true-or-false" class="anchor" aria-hidden="true"></a>Exactly Like the <code>expect_*()</code> Functions Except You Get a <code>TRUE</code> or <code>FALSE</code>
</h1>
<p>The interface of each <code>test_*()</code> function is an exact match to the <code>expect_*()</code> counterpart. If you haven’t used either of those but have used the standard validation functions, here’s a quick rundown.</p>
<p>The following arguments from the validation functions (e.g., <code><a href="../reference/col_vals_in_set.html">col_vals_in_set()</a></code> and many more) have been removed in the corresponding <code>test_*()</code> functions:</p>
<ul>
<li><code>actions</code></li>
<li><code>step_id</code></li>
<li><code>label</code></li>
<li><code>brief</code></li>
<li><code>active</code></li>
</ul>
<p>Instead of <code>actions</code> we do get the <code>threshold</code> argument as a simplified replacement. What’s supplied here is a single failure threshold value. By default this is set to <code>1</code> meaning that a single test that fails will result in an overall failure and the return of <code>FALSE</code> (otherwise, <code>TRUE</code>).</p>
<p>The rules for threshold setting (in <code><a href="../reference/action_levels.html">action_levels()</a></code>, <code><a href="../reference/action_levels.html">warn_on_fail()</a></code>, and <code><a href="../reference/action_levels.html">stop_on_fail()</a></code>) will be explained in some detail here. Whole numbers beyond <code>1</code> indicate that any failing units up to that absolute threshold value will result in a <code>TRUE</code>. Likewise, fractional values (between <code>0</code> and <code>1</code>) act as a proportional failure threshold, where <code>0.25</code> means that 25% or more failing test units results in a <code>FALSE</code>.</p>
<p>We can use the <code>preconditions</code> argument in cases where we’d like to transform the input data before evaluation of the test. If you would like to do things to the input table like summarize it, perform filtering, mutate one or more columns, perform table joins, etc., then this is a good way to go about that.</p>
</div>
<div id="heres-several-examples-quick-snap" class="section level1">
<h1 class="hasAnchor">
<a href="#heres-several-examples-quick-snap" class="anchor" aria-hidden="true"></a>Here’s Several Examples Quick Snap</h1>
<p>Let’s have some examples before leaving this article. They will all use our <code>small_table</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">small_table</span></code></pre></div>
<pre><code>##  [38;5;246m# A tibble: 13 × 8 [39m
##    date_time           date           a b             c      d e     f    
##     [3m [38;5;246m&lt;dttm&gt; [39m [23m               [3m [38;5;246m&lt;date&gt; [39m [23m      [3m [38;5;246m&lt;int&gt; [39m [23m  [3m [38;5;246m&lt;chr&gt; [39m [23m      [3m [38;5;246m&lt;dbl&gt; [39m [23m   [3m [38;5;246m&lt;dbl&gt; [39m [23m  [3m [38;5;246m&lt;lgl&gt; [39m [23m  [3m [38;5;246m&lt;chr&gt; [39m [23m
##  [38;5;250m 1 [39m 2016-01-04  [38;5;246m11:00:00 [39m 2016-01-04     2 1-bcd-345     3   [4m3 [24m423. TRUE  high 
##  [38;5;250m 2 [39m 2016-01-04  [38;5;246m00:32:00 [39m 2016-01-04     3 5-egh-163     8  [4m1 [24m [4m0 [24m000. TRUE  low  
##  [38;5;250m 3 [39m 2016-01-05  [38;5;246m13:32:00 [39m 2016-01-05     6 8-kdg-938     3   [4m2 [24m343. TRUE  high 
##  [38;5;250m 4 [39m 2016-01-06  [38;5;246m17:23:00 [39m 2016-01-06     2 5-jdo-903     [31mNA [39m   [4m3 [24m892. FALSE mid  
##  [38;5;250m 5 [39m 2016-01-09  [38;5;246m12:36:00 [39m 2016-01-09     8 3-ldm-038     7   284. TRUE  low  
##  [38;5;250m 6 [39m 2016-01-11  [38;5;246m06:15:00 [39m 2016-01-11     4 2-dhe-923     4   [4m3 [24m291. TRUE  mid  
##  [38;5;250m 7 [39m 2016-01-15  [38;5;246m18:46:00 [39m 2016-01-15     7 1-knw-093     3   843. TRUE  high 
##  [38;5;250m 8 [39m 2016-01-17  [38;5;246m11:27:00 [39m 2016-01-17     4 5-boe-639     2   [4m1 [24m036. FALSE low  
##  [38;5;250m 9 [39m 2016-01-20  [38;5;246m04:30:00 [39m 2016-01-20     3 5-bce-642     9   838. FALSE high 
##  [38;5;250m10 [39m 2016-01-20  [38;5;246m04:30:00 [39m 2016-01-20     3 5-bce-642     9   838. FALSE high 
##  [38;5;250m11 [39m 2016-01-26  [38;5;246m20:07:00 [39m 2016-01-26     4 2-dmx-010     7   834. TRUE  low  
##  [38;5;250m12 [39m 2016-01-28  [38;5;246m02:51:00 [39m 2016-01-28     2 7-dmx-010     8   108. FALSE low  
##  [38;5;250m13 [39m 2016-01-30  [38;5;246m11:23:00 [39m 2016-01-30     1 3-dka-303     [31mNA [39m   [4m2 [24m230. TRUE  high</code></pre>
<p>If you’d like to test your <strong>pointblank</strong> validation skill, guess whether each of these is <code>TRUE</code> or <code>FALSE</code> before hovering over the line of code. <br><br></p>

<style>
.btn {
  box-sizing: border-box;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  border: 1px solid gray;
  color: black;
  cursor: pointer;
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
  align-self: center;
  font-weight: 500;
  line-height: 1.2;
  text-decoration: none;
  text-align: center;
}
.btn:hover, .btn:focus {
  color: black;
  outline: 0;
}

.true {
  -webkit-transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
  border-color: gray;
  color: black;
  transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
}
.true:hover {
  box-shadow: 0 0 40px 40px lightgreen inset;
  border: 1px solid green;
}
.true:hover::after {
  box-shadow: none;
  font-weight: 600;
  content: 'TRUE';
}
.true code {
  padding: 1px 4px 2px 4px;
  background: transparent;
  text-align: left;
}

.false {
  -webkit-transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
  border-color: gray;
  color: black;
  transition: box-shadow 200ms ease-in-out, color 200ms ease-in-out;
}
.false:hover {
  box-shadow: 0 0 40px 40px #CC0000 inset;
  color: white;
  border: 1px solid #7A0000;
}
.false:hover::after {
  box-shadow: none;
  font-weight: 600;
  text-align: right;
  content: 'FALSE';
}
.false code {
  padding: 1px 4px 2px 4px;
  background: transparent;
  text-align: left;
}


</style>
<button class="btn true">
<code>small_table %&gt;%
  test_col_is_logical(vars(e))</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_vals_between(
    vars(c), left = 1, right = 10
  )</code>
</button>

<br><button class="btn true">
<code>small_table %&gt;% 
  test_col_vals_between(
    vars(c), left = 0, right = vars(d),
    na_pass = TRUE, threshold = 0.5
  )</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_vals_between(
    vars(c), left = 0, right = vars(d),
    na_pass = TRUE, threshold = 3
  )</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_schema_match(
    col_schema(.tbl = small_table_sqlite())
  )</code>
</button>

<br><button class="btn true">
<code>small_table %&gt;%
  test_col_vals_regex(vars(b), regex = ".-[a-z]{3}.*")
</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% test_col_exists(columns = "g")</code>
</button>

<br><button class="btn false">
<code>small_table %&gt;% 
  test_col_vals_gt(
    vars(z), value = vars(a),
    preconditions = ~ . %&gt;% dplyr::mutate(z = c + e), threshold = 0.5
  )</code>
</button>

<p><br> And there you have it. A nice set of examples revealing their truthy/falsy nature only <code>::after</code> closer inspection.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Richard Iannone, Mauricio Vargas.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
