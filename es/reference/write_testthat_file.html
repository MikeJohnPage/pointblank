<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Con un objeto pointblank agent, podemos escribir un archivo de prueba
testthat y optar por colocarlo en testthat/tests si está disponible en
la ruta del proyecto (también podemos especificar una ruta alternativa). Esto
funciona transformando los pasos de validación en una serie de llamadas a
expect_*() dentro de declaraciones individuales testthat::test_that().
Un requisito indispensable para utilizar write_testthat_file() en un agente
es la presencia de una read_fn, que es una función que se invoca para
obtener la tabla de destino. La sentencia read_fn se colocará en la parte
superior del archivo de prueba testthat para que la tabla de destino esté
disponible para cada una de las sentencias testthat::test_that() que le
siguen. Si un objeto agent no tiene una read_fn puede añadirse a través
de set_read_fn().
Los umbrales se obtendrán a partir de los aplicados para el estado stop.
Esto puede configurarse para un objeto agente* en blanco pasando un objeto
action_levels al argumento actions de create_agent() o el mismo
argumento de cualquier función de validación incluida. Si los umbrales stop
no están disponibles, se utilizará un valor de umbral de 1 para cada
sentencia expect_*() generada en el archivo de prueba testthat
resultante.
No es necesario que el objeto agent se someta primero a una interrogación
con interrogate(). Sin embargo, puede ser útil como prueba de
funcionamiento realizar interactivamente una interrogación en los datos de
destino antes de generar el archivo de prueba testthat."><title>Transforma un agente pointblank en un testthat archivo de prueba — write_testthat_file • pointblank</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transforma un agente pointblank en un testthat archivo de prueba — write_testthat_file"><meta property="og:description" content="Con un objeto pointblank agent, podemos escribir un archivo de prueba
testthat y optar por colocarlo en testthat/tests si está disponible en
la ruta del proyecto (también podemos especificar una ruta alternativa). Esto
funciona transformando los pasos de validación en una serie de llamadas a
expect_*() dentro de declaraciones individuales testthat::test_that().
Un requisito indispensable para utilizar write_testthat_file() en un agente
es la presencia de una read_fn, que es una función que se invoca para
obtener la tabla de destino. La sentencia read_fn se colocará en la parte
superior del archivo de prueba testthat para que la tabla de destino esté
disponible para cada una de las sentencias testthat::test_that() que le
siguen. Si un objeto agent no tiene una read_fn puede añadirse a través
de set_read_fn().
Los umbrales se obtendrán a partir de los aplicados para el estado stop.
Esto puede configurarse para un objeto agente* en blanco pasando un objeto
action_levels al argumento actions de create_agent() o el mismo
argumento de cualquier función de validación incluida. Si los umbrales stop
no están disponibles, se utilizará un valor de umbral de 1 para cada
sentencia expect_*() generada en el archivo de prueba testthat
resultante.
No es necesario que el objeto agent se someta primero a una interrogación
con interrogate(). Sin embargo, puede ser útil como prueba de
funcionamiento realizar interactivamente una interrogación en los datos de
destino antes de generar el archivo de prueba testthat."><meta property="og:image" content="https://rich-iannone.github.io/pointblank/es/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Ir al contenido</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pointblank</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Cambiar la navegación">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Flujos de trabajo de validación</h6>
    <a class="dropdown-item" href="../articles/validation_workflows.html">Overview</a>
    <a class="dropdown-item" href="../articles/VALID-I.html">VALID-I: Informes sobre la calidad de los datos</a>
    <a class="dropdown-item" href="../articles/VALID-II.html">VALID-II: Validación de datos en los pipelines</a>
    <a class="dropdown-item" href="../articles/VALID-III.html">VALID-III: Expectativas en las pruebas unitarias</a>
    <a class="dropdown-item" href="../articles/VALID-IV.html">VALID-IV: Pruebas de datos para condicionales</a>
    <a class="dropdown-item" href="../articles/VALID-V.html">VALID-V: Table Scan</a>
    <a class="dropdown-item" href="../articles/VALID-VI.html">VALID-VI: Validación de documentos R Markdown</a>
    <h6 class="dropdown-header" data-toc-skip>Gestión de la información</h6>
    <a class="dropdown-item" href="../articles/INFO-1.html">Introducción a la gestión de la información</a>
    <a class="dropdown-item" href="../articles/INFO-2.html">Temas avanzados de gestión de la información</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://rich-iannone.github.io/pointblank">In English</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Cambiar la navegación" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Buscar" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rich-iannone/pointblank/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Transforma un agente <strong>pointblank</strong> en un <strong>testthat</strong> archivo de prueba</h1>
      <small class="dont-index">Código: <a href="https://github.com/rich-iannone/pointblank/blob/HEAD/R/write_testthat_file.R" class="external-link"><code>R/write_testthat_file.R</code></a></small>
      <div class="d-none name"><code>write_testthat_file.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Con un objeto <strong>pointblank</strong> <em>agent</em>, podemos escribir un archivo de prueba
<strong>testthat</strong> y optar por colocarlo en <code>testthat/tests</code> si está disponible en
la ruta del proyecto (también podemos especificar una ruta alternativa). Esto
funciona transformando los pasos de validación en una serie de llamadas a
<code>expect_*()</code> dentro de declaraciones individuales <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">testthat::test_that()</a></code>.</p>
<p>Un requisito indispensable para utilizar <code>write_testthat_file()</code> en un agente
es la presencia de una <code>read_fn</code>, que es una función que se invoca para
obtener la tabla de destino. La sentencia <code>read_fn</code> se colocará en la parte
superior del archivo de prueba <strong>testthat</strong> para que la tabla de destino esté
disponible para cada una de las sentencias <code><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">testthat::test_that()</a></code> que le
siguen. Si un objeto <em>agent</em> no tiene una <code>read_fn</code> puede añadirse a través
de <code><a href="set_read_fn.html">set_read_fn()</a></code>.</p>
<p>Los umbrales se obtendrán a partir de los aplicados para el estado <code>stop</code>.
Esto puede configurarse para un objeto <em>agente</em>* en blanco pasando un objeto
<code>action_levels</code> al argumento <code>actions</code> de <code><a href="create_agent.html">create_agent()</a></code> o el mismo
argumento de cualquier función de validación incluida. Si los umbrales <code>stop</code>
no están disponibles, se utilizará un valor de umbral de <code>1</code> para cada
sentencia <code>expect_*()</code> generada en el archivo de prueba <strong>testthat</strong>
resultante.</p>
<p>No es necesario que el objeto <strong>agent</strong> se someta primero a una interrogación
con <code><a href="interrogate.html">interrogate()</a></code>. Sin embargo, puede ser útil como prueba de
funcionamiento realizar interactivamente una interrogación en los datos de
destino antes de generar el archivo de prueba <strong>testthat</strong>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Uso<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">write_testthat_file</span><span class="op">(</span>
  <span class="va">agent</span>,
  name <span class="op">=</span> <span class="cn">NULL</span>,
  path <span class="op">=</span> <span class="cn">NULL</span>,
  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,
  skips <span class="op">=</span> <span class="cn">NULL</span>,
  quiet <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="argumentos">Argumentos<a class="anchor" aria-label="anchor" href="#argumentos"></a></h2>
    <dl><dt>agent</dt>
<dd><p>Un objeto de agente de clase <code>ptblank_agent</code>.</p></dd>
<dt>name</dt>
<dd><p>Un nombre opcional para el archivo de prueba <strong>testhat</strong>. Debe
ser un nombre sin extensión y sin el texto inicial <code>"test-"</code>. Si no se
suministra nada, el nombre se derivará del <code>tbl_name</code> en el objeto agente.
Si no está presente, se utilizará un nombre genérico.</p></dd>
<dt>path</dt>
<dd><p>Aquí se puede especificar una ruta si no se debe intentar colocar
el archivo en <code>testthat/tests</code>.</p></dd>
<dt>overwrite</dt>
<dd><p>¿Debe sobrescribirse un archivo <strong>testthat</strong> del mismo
nombre? Por defecto, esto es <code>FALSE</code>.</p></dd>
<dt>skips</dt>
<dd><p>Se trata de un vector opcional de palabras clave de omisión de
pruebas modelado a partir de las funciones <strong>testthat</strong> <code>skip_on_*()</code>. Las
siguientes palabras clave pueden utilizarse para incluir declaraciones
<code>skip_on_*()</code>: <code>"cran"</code> (<code><a href="https://testthat.r-lib.org/reference/skip.html" class="external-link">testthat::skip_on_cran()</a></code>), <code>"travis"</code>
(<code><a href="https://testthat.r-lib.org/reference/skip.html" class="external-link">testthat::skip_on_travis()</a></code>), <code>"appveyor"</code>
(<code><a href="https://testthat.r-lib.org/reference/skip.html" class="external-link">testthat::skip_on_appveyor()</a></code>), <code>"ci"</code> (<code><a href="https://testthat.r-lib.org/reference/skip.html" class="external-link">testthat::skip_on_ci()</a></code>),
<code>"covr"</code> (<code><a href="https://testthat.r-lib.org/reference/skip.html" class="external-link">testthat::skip_on_covr()</a></code>), <code>"bioc"</code>
(<code><a href="https://testthat.r-lib.org/reference/skip.html" class="external-link">testthat::skip_on_bioc()</a></code>). Existen palabras clave para omitir pruebas en
determinados sistemas operativos y todas ellas insertarán una llamada
específica <code><a href="https://testthat.r-lib.org/reference/skip.html" class="external-link">testthat::skip_on_os()</a></code>. Estas son <code>"windows"</code>
(<code>skip_on_os("windows")</code>), <code>"mac"</code> (<code>skip_on_os("mac")</code>), <code>"linux"</code>
(<code>skip_on_os("linux")</code>) y <code>"solaris"</code> (<code>skip_on_os("solaris")</code>). Estas
declaraciones se colocarán en la parte superior del archivo de prueba
<strong>testthat</strong> generado.</p></dd>
<dt>quiet</dt>
<dd><p>¿La función no debe informar cuando se escribe el archivo? En
por defecto es <code>FALSE</code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="valor">Valor<a class="anchor" aria-label="anchor" href="#valor"></a></h2>
    <p>Devuelve invisiblemente <code>TRUE</code> si el archivo <strong>testthat</strong> ha sido
escrito.</p>
    </div>
    <div class="section level2">
    <h2 id="detalles">Detalles<a class="anchor" aria-label="anchor" href="#detalles"></a></h2>
    <p>Las pruebas de los pasos de validación inactivos se omitirán con un mensaje
claro que indique que el motivo de la omisión se debe a que la prueba no está
activa. Cualquier paso de validación inactivo puede ser forzado a un estado
activo utilizando la función <code><a href="activate_steps.html">activate_steps()</a></code> en un objeto <em>agent</em> (lo
contrario es posible con la función <code><a href="deactivate_steps.html">deactivate_steps()</a></code>).</p>
<p>El paquete <strong>testthat</strong> viene con una serie de funciones <code>skip_on_*()</code> que
convenientemente hacen que el archivo de prueba se salte por completo si se
cumplen ciertas condiciones. Podemos establecer rápidamente cualquier número
de ellas en la parte superior del archivo de prueba <strong>testthat</strong>
suministrando palabras clave como un vector a la opción <code>skips</code> de
<code>write_testthat_file()</code>. Por ejemplo, si establecemos
<code>skips = c("cran", "windows)</code> añadiremos el código <code>skip_on_cran()</code> y
<code>skip_on_os("windows")</code>, lo que significa que el archivo de prueba generado
no se ejecutará en un sistema CRAN o si el sistema operativo es Windows.</p>
<p>Este es un ejemplo de la salida del archivo de prueba <strong>testthat</strong>:</p>
<p><code>test-small_table.R</code></p><div class="sourceCode"><pre><code><span class="co"># Generated by pointblank</span>

<span class="va">tbl</span> <span class="op">&lt;-</span> <span class="va">small_table</span>

<span class="fu">test_that</span><span class="op">(</span><span class="st">"column `date_time` exists"</span>, <span class="op">{</span>
  
  <span class="fu"><a href="../reference/col_exists.html">expect_col_exists</a></span><span class="op">(</span>
    <span class="va">tbl</span>,
    columns <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">date_time</span><span class="op">)</span>,
    threshold <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> 
<span class="op">}</span><span class="op">)</span>

<span class="fu">test_that</span><span class="op">(</span><span class="st">"values in `c` should be &lt;= `5`"</span>, <span class="op">{</span>
  
  <span class="fu"><a href="../reference/col_vals_lte.html">expect_col_vals_lte</a></span><span class="op">(</span>
    <span class="va">tbl</span>,
    columns <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>,
    value <span class="op">=</span> <span class="fl">5</span>,
    threshold <span class="op">=</span> <span class="fl">0.25</span>
  <span class="op">)</span> 
<span class="op">}</span><span class="op">)</span></code></pre></div>

<p>Esto fue generado por el siguiente conjunto de declaraciones:</p><div class="sourceCode"><pre><code><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rich-iannone.github.io/pointblank/" class="external-link">pointblank</a></span><span class="op">)</span>

<span class="va">agent</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/create_agent.html">create_agent</a></span><span class="op">(</span>
    read_fn <span class="op">=</span> <span class="op">~</span> <span class="va">small_table</span>,
    actions <span class="op">=</span> <span class="fu"><a href="../reference/action_levels.html">action_levels</a></span><span class="op">(</span>stop_at <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/col_exists.html">col_exists</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">date_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/col_vals_lte.html">col_vals_lte</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>, value <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
  
<span class="fu"><a href="../reference/write_testthat_file.html">write_testthat_file</a></span><span class="op">(</span>
  agent <span class="op">=</span> <span class="va">agent</span>,
  name <span class="op">=</span> <span class="st">"small_table"</span>,
  path <span class="op">=</span> <span class="st">"."</span>
<span class="op">)</span></code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="function-id">Function ID<a class="anchor" aria-label="anchor" href="#function-id"></a></h2>
    

<p>8-5</p>
    </div>
    <div class="section level2">
    <h2 id="ver-tambi-n">Ver también<a class="anchor" aria-label="anchor" href="#ver-tambi-n"></a></h2>
    <div class="dont-index"><p>Other Post-interrogation: 
<code><a href="all_passed.html">all_passed</a>()</code>,
<code><a href="get_agent_x_list.html">get_agent_x_list</a>()</code>,
<code><a href="get_data_extracts.html">get_data_extracts</a>()</code>,
<code><a href="get_sundered_data.html">get_sundered_data</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Ejemplos<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># La creación de un objeto `action_levels`</span></span>
<span class="r-in"><span class="co"># es un paso común del flujo de trabajo al</span></span>
<span class="r-in"><span class="co"># crear un agente pointblank; designamos</span></span>
<span class="r-in"><span class="co"># los umbrales de fallo a los estados</span></span>
<span class="r-in"><span class="co"># `warn`, `stop` y `notify` utilizando</span></span>
<span class="r-in"><span class="co"># `action_levels()`</span></span>
<span class="r-in"><span class="va">al</span> <span class="op">&lt;-</span> </span>
<span class="r-in">  <span class="fu"><a href="action_levels.html">action_levels</a></span><span class="op">(</span></span>
<span class="r-in">    warn_at <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span class="r-in">    stop_at <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span class="r-in">    notify_at <span class="op">=</span> <span class="fl">0.35</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># A pointblank `agent` object is now</span></span>
<span class="r-in"><span class="co"># created and the `al` object is provided</span></span>
<span class="r-in"><span class="co"># to the agent; the static thresholds</span></span>
<span class="r-in"><span class="co"># provided by `al` make reports a bit</span></span>
<span class="r-in"><span class="co"># more useful after interrogation</span></span>
<span class="r-in"><span class="va">agent</span> <span class="op">&lt;-</span> </span>
<span class="r-in">  <span class="fu"><a href="create_agent.html">create_agent</a></span><span class="op">(</span></span>
<span class="r-in">    read_fn <span class="op">=</span> <span class="op">~</span> <span class="va">small_table</span>,</span>
<span class="r-in">    label <span class="op">=</span> <span class="st">"Un ejemplo."</span>,</span>
<span class="r-in">    actions <span class="op">=</span> <span class="va">al</span></span>
<span class="r-in">  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="col_exists.html">col_exists</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">date_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="col_vals_regex.html">col_vals_regex</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>,</span>
<span class="r-in">    regex <span class="op">=</span> <span class="st">"[0-9]-[a-z]{3}-[0-9]{3}"</span></span>
<span class="r-in">  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="col_vals_gt.html">col_vals_gt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, value <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="col_vals_lte.html">col_vals_lte</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>, value <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="interrogate.html">interrogate</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># This agent and all of the checks can</span></span>
<span class="r-in"><span class="co"># be transformed into a testthat file</span></span>
<span class="r-in"><span class="co"># with `write_testthat_file()`; the `stop`</span></span>
<span class="r-in"><span class="co"># thresholds will be ported over</span></span>
<span class="r-in"><span class="fu">write_testthat_file</span><span class="op">(</span></span>
<span class="r-in">  agent <span class="op">=</span> <span class="va">agent</span>,</span>
<span class="r-in">  name <span class="op">=</span> <span class="st">"small_table"</span>,</span>
<span class="r-in">  path <span class="op">=</span> <span class="st">"."</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The above code will generate a file with</span></span>
<span class="r-in"><span class="co"># the name `test-small_table.R`; the path</span></span>
<span class="r-in"><span class="co"># was specified with `"."` but, by default,</span></span>
<span class="r-in"><span class="co"># the function will place the file in the</span></span>
<span class="r-in"><span class="co"># `tests/testthat` folder if it's available</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># An agent on disk as a YAML file can be</span></span>
<span class="r-in"><span class="co"># made into a testthat file; the</span></span>
<span class="r-in"><span class="co"># 'agent-small_table.yml' file is</span></span>
<span class="r-in"><span class="co"># available in the package through</span></span>
<span class="r-in"><span class="co"># `system.file()`</span></span>
<span class="r-in"><span class="va">yml_file</span> <span class="op">&lt;-</span> </span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="st">"yaml"</span>, <span class="st">"agent-small_table.yml"</span>,</span>
<span class="r-in">    package <span class="op">=</span> <span class="st">"pointblank"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Writing the testthat file into the</span></span>
<span class="r-in"><span class="co"># working directory is much the same</span></span>
<span class="r-in"><span class="co"># as before but we're reading the</span></span>
<span class="r-in"><span class="co"># agent from disk this time</span></span>
<span class="r-in"><span class="fu">write_testthat_file</span><span class="op">(</span></span>
<span class="r-in">  agent <span class="op">=</span> <span class="fu"><a href="yaml_read_agent.html">yaml_read_agent</a></span><span class="op">(</span><span class="va">yml_file</span><span class="op">)</span>,</span>
<span class="r-in">  name <span class="op">=</span> <span class="st">"from_agent_yaml"</span>,</span>
<span class="r-in">  path <span class="op">=</span> <span class="st">"."</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>En esta página</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Desarrollado por Richard Iannone, Mauricio Vargas.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Sitio creado con <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

